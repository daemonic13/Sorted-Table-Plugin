(function(d){d.fn.sortedtable=function(i){var j=this,f=d.extend({},d.fn.sortedtable.defaults,i);sortFns=d.extend({},{"int":function(d,f){return parseInt(d,10)-parseInt(f,10)},"float":function(d,f){return parseFloat(d)-parseFloat(f)},string:null},f.sortFns);j.delegate("th","click",function(){var h=j.find("tbody tr"),i=d(this).index(),a=d(this).attr("class"),c=null,k=d(this);if(a){for(var a=a.split(/\s+/),b=0;b<a.length;b++)if(-1!=a[b].search("type-")){c=a[b];break}c=c?c.split("-")[1]:"string"}if(!c)return!1;
a=sortFns[c];column=[];h.each(function(a,c){var b=d(c).children().eq(i),b=b.attr("data-order-by")||(f.trimtext?b.text().trim():b.text());column.push(b)});var c=[],e=column,b=e.slice(0),g=e.slice(0).reverse(),e=e.slice(0).sort(a);if(b&&e&&!(b<e||e<b)||g&&e&&!(g<e||e<g)){column.reverse();for(a=column.length-1;0<=a;a--)c.push(a)}else{c=column;a=c.slice(0).sort(a);b=[];for(e=g=0;e<c.length;e++){for(g=d.inArray(c[e],a);-1!=d.inArray(g,b);)g++;b.push(g)}c=b}a=c;c=h.slice(0);for(b=0;b<a.length;b++)newIndex=
a[b],c[newIndex]=h[b];h=d(c);f.useicon&&(k.siblings().find(".sorticon").remove(),a=k.find(".sorticon"),0<a.length?a.toggleClass(f.iconascending+" "+f.icondescending):(a=d(document.createElement("span")),a.addClass("ui-icon sorticon").addClass(f.icondescending),a.css({display:"inline-block",verticalAlign:"middle"}),k.append(a)));j.find("tbody").append(h)})};d.fn.sortedtable.defaults={icondescending:"ui-icon-triangle-1-s",iconascending:"ui-icon-triangle-1-n",useicon:!0,trimtext:!0,sortFns:{}}})(jQuery);